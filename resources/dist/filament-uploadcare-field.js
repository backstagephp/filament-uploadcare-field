var f=class{constructor(e){this.wrapper=e,this.observer=null,this.init()}init(){this.hideDoneButtons(),this.setupObserver()}setupObserver(){this.observer=new MutationObserver(e=>{e.forEach(t=>{t.type==="childList"&&t.addedNodes.forEach(i=>{if(i.nodeType===Node.ELEMENT_NODE){i.classList&&i.classList.contains("uc-done-btn")&&this.hideDoneButton(i);let s=i.querySelectorAll&&i.querySelectorAll(".uc-done-btn");s&&s.forEach(a=>this.hideDoneButton(a))}})})}),this.wrapper&&this.observer.observe(this.wrapper,{childList:!0,subtree:!0})}hideDoneButtons(){document.querySelectorAll(".uc-done-btn").forEach(t=>this.hideDoneButton(t))}hideDoneButton(e){e&&(e.style.display="none",e.style.visibility="hidden",e.style.opacity="0",e.style.pointerEvents="none",e.style.position="absolute",e.style.width="0",e.style.height="0",e.style.overflow="hidden",e.style.clip="rect(0, 0, 0, 0)",e.style.margin="0",e.style.padding="0",e.style.border="0",e.style.background="transparent",e.style.color="transparent",e.style.fontSize="0",e.style.lineHeight="0")}destroy(){this.observer&&(this.observer.disconnect(),this.observer=null)}};function U(p){return window._initializedUploadcareContexts||(window._initializedUploadcareContexts=new Set),{state:p.state,statePath:p.statePath,initialState:p.initialState,publicKey:p.publicKey,isMultiple:p.isMultiple,multipleMin:p.multipleMin,multipleMax:p.multipleMax,isImagesOnly:p.isImagesOnly,accept:p.accept,sourceList:p.sourceList,uploaderStyle:p.uploaderStyle,isWithMetadata:p.isWithMetadata,localeName:p.localeName||"en",uploadedFiles:"",ctx:null,removeEventListeners:null,uniqueContextName:p.uniqueContextName,pendingUploads:[],pendingRemovals:[],isInitialized:!1,stateHasBeenInitialized:!1,isStateWatcherActive:!1,isLocalUpdate:!1,doneButtonHider:null,documentClassObserver:null,formInputObserver:null,log(e,t={}){console.log(`[UC-DEBUG] [${this.uniqueContextName}] [${new Date().toISOString().split("T")[1]}] ${e}`,t)},async init(){if(this.log("INIT STARTED",{state:this.state,isConnected:this.$el.isConnected,isInitialized:this.isInitialized}),this.isContextAlreadyInitialized()){this.log("Context already initialized, skipping");return}if(this.markContextAsInitialized(),this.applyTheme(),await this.loadAllLocales(),!this.$el.isConnected){this.log("Component disconnected after loadAllLocales, aborting init (ZOMBIE KILL)");return}this.log("Locales loaded",{isConnected:this.$el.isConnected}),this.setupStateWatcher(),this.$el.addEventListener("uploadcare-state-updated",e=>{this.log("uploadcare-state-updated event",e.detail);let t=e.detail.uuid;t&&this.isInitialized?this.loadFileFromUuid(t):t&&this.$nextTick(()=>{this.isInitialized&&this.loadFileFromUuid(t)})}),this.initUploadcare(),this.setupThemeObservers(),this.setupDoneButtonObserver(),(!this.state||this.state==="[]"||this.state==='""')&&this.$nextTick(()=>{this.isInitialized&&this.getCurrentFiles().length>0&&(this.log("Proactive clear triggering clearAllFiles(SILENT)"),this.clearAllFiles(!1))})},isContextAlreadyInitialized(){return window._initializedUploadcareContexts.has(this.uniqueContextName)},markContextAsInitialized(){window._initializedUploadcareContexts.add(this.uniqueContextName)},async loadAllLocales(){window._uploadcareAllLocalesLoaded||await new Promise(t=>{if(window._uploadcareAllLocalesLoaded){t();return}let i=setInterval(()=>{window._uploadcareAllLocalesLoaded&&(clearInterval(i),t())},100);setTimeout(()=>{clearInterval(i),t()},5e3)});let e=["de","es","fr","he","it","nl","pl","pt","ru","tr","uk","zh-TW","zh"];document.querySelectorAll("uc-config[data-locale-name]").forEach(t=>{let i=t.getAttribute("data-locale-name");i&&e.includes(i)&&!t.getAttribute("locale-name")&&t.setAttribute("locale-name",i)})},async loadLocale(){if(this.localeName==="en"||this.localeLoaded)return;if(window._uploadcareLocales&&window._uploadcareLocales.has(this.localeName)){this.localeLoaded=!0;return}if(window._uploadcareLocales||(window._uploadcareLocales=new Set),!!["de","es","fr","he","it","nl","pl","pt","ru","tr","uk","zh-TW","zh"].includes(this.localeName))try{let i=await import(`https://cdn.jsdelivr.net/npm/@uploadcare/file-uploader@v1/locales/file-uploader/${this.localeName}.js`),s=i.default||i,a=()=>{let r=customElements.get("uc-file-uploader-inline")||customElements.get("uc-file-uploader-regular")||customElements.get("uc-file-uploader-minimal");return r&&r.UC?r.UC:window.UC},n=()=>{let r=a();return r&&typeof r.defineLocale=="function"?(r.defineLocale(this.localeName,s),window._uploadcareLocales.add(this.localeName),this.localeLoaded=!0,!0):!1};if(!n()){let r=0,o=50,c=setInterval(()=>{r++,(n()||r>=o)&&clearInterval(c)},100)}}catch(t){console.error("[Uploadcare Locale JS] Failed to load locale:",this.localeName,t)}},applyTheme(){let e=this.getCurrentTheme();this.$el.querySelectorAll(`uc-file-uploader-${this.uploaderStyle}`).forEach(i=>{i.classList.remove("uc-dark","uc-light"),i.classList.add(`uc-${e}`)})},getCurrentTheme(){return document.documentElement.classList.contains("dark")?"dark":"light"},setupThemeObservers(){window.addEventListener("storage",this.handleThemeStorageChange.bind(this)),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",this.handleSystemThemeChange.bind(this)),this.setupDocumentClassObserver()},handleThemeStorageChange(e){e.key==="theme"&&this.applyTheme()},handleSystemThemeChange(){localStorage.getItem("theme")==="system"&&this.applyTheme()},setupDocumentClassObserver(){this.documentClassObserver=new MutationObserver(e=>{e.forEach(t=>{if(t.type==="attributes"&&t.attributeName==="class"){let i=document.documentElement.classList.contains("dark"),s=t.oldValue&&t.oldValue.includes("dark");i!==s&&this.applyTheme()}})}),this.documentClassObserver.observe(document.documentElement,{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]})},initUploadcare(){this.removeEventListeners&&this.removeEventListeners(),this.initializeUploader()},initializeUploader(e=0,t=10){if(e>=t)return;this.ctx=this.$el.querySelector(`uc-upload-ctx-provider[ctx-name="${this.uniqueContextName}"]`);let i=this.getUploadcareApi();if(!this.isValidContext(i)){setTimeout(()=>this.initializeUploader(e+1,t),100);return}this.markAsInitialized(),this.removeRequiredAttributes(),this.initializeState(i),this.setupEventListeners(i)},getUploadcareApi(){try{return this.ctx?.getAPI()}catch{return null}},isValidContext(e){return this.ctx&&e&&e.addFileFromCdnUrl},markAsInitialized(){this.isInitialized=!0},removeRequiredAttributes(){setTimeout(()=>{let e=this.$el.closest("uc-config");document.querySelectorAll("uc-form-input input[required]").forEach(i=>i.removeAttribute("required"))},100)},initializeState(e){this.initialState&&!this.stateHasBeenInitialized&&!this.uploadedFiles?this.loadInitialState(e):!this.initialState&&!this.stateHasBeenInitialized&&(this.stateHasBeenInitialized=!0,this.uploadedFiles=this.isMultiple?"[]":"",this.isLocalUpdate=!0,this.state=this.uploadedFiles)},loadInitialState(e){try{let t=this.parseInitialState();this.addFilesFromInitialState(e,t),this.stateHasBeenInitialized=!0,this.isLocalUpdate=!0,this.state=this.uploadedFiles}catch(t){console.error("Error parsing initialState:",t)}},parseInitialState(){let e=i=>{if(typeof i=="string")try{let s=JSON.parse(i);if(typeof s=="string")try{s=JSON.parse(s)}catch{}return s}catch{return i}return i};this.initialState&&this.initialState&&typeof this.initialState=="object"&&!Array.isArray(this.initialState)&&(this.initialState=[this.initialState]);let t=this.parseStateValue(this.initialState);return console.log(`[Uploadcare ${this.statePath}] initializeState`,{hasInitialState:!!this.initialState,parsedCount:Array.isArray(t)?t.length:"n/a"}),t},addFilesFromInitialState(e,t){let i=[];if(t&&t&&typeof t=="object"&&!Array.isArray(t))try{i=Array.from(t)}catch{i=[t]}else Array.isArray(t)?i=t:t&&(i=[t]);if(Array.isArray(i)&&i.length===1&&Array.isArray(i[0])&&(i=i[0]),Array.isArray(i)&&i.length===1&&typeof i[0]=="string")try{let r=JSON.parse(i[0]);i=Array.isArray(r)?r:[r]}catch{}if(!Array.isArray(i)||i.length===0)return;Array.isArray(i)||(i=[i]);let s=(r,o=0)=>{if(!r)return;if(Array.isArray(r)){r.forEach((u,d)=>{s(u,`${o}.${d}`)});return}if(typeof r=="string")try{let u=JSON.parse(r);s(u,o);return}catch{}let c=r&&typeof r=="object"?r.cdnUrl:r,h=r&&typeof r=="object"?r.cdnUrlModifiers:null;if(console.log(`[Uploadcare ${this.statePath}] addFilesFromInitialState adding item`,{index:o,url:c}),!c||!this.isValidUrl(c))return;let l=this.extractUuidFromUrl(c);if(l&&typeof e.addFileFromUuid=="function")try{if(h&&typeof e.addFileFromCdnUrl=="function"){let d=c.split("/-/")[0]+"/"+h;e.addFileFromCdnUrl(d)}else e.addFileFromUuid(l)}catch(u){console.error(`Failed to add file ${o} with UUID ${l}:`,u)}else console.error(l?"addFileFromUuid method not available on API":`Could not extract UUID from URL: ${c}`)};i.forEach(s);let a=i.map(r=>{let o=r;if(r&&typeof r=="object")return r.uuid||(r.uuid=this.extractUuidFromUrl(r.cdnUrl)),r;if(typeof r=="string"){let c=this.extractUuidFromUrl(r);return{cdnUrl:r,uuid:c,name:"",size:0,mimeType:"",isImage:!1}}return r}),n=this.formatFilesForState(a);this.uploadedFiles=JSON.stringify(n),this.initialState=this.uploadedFiles},isValidUrl(e){if(!e||typeof e!="string")return!1;try{return new URL(e),!0}catch{return!1}},setupStateWatcher(){this.$watch("state",(e,t)=>{if(this.isLocalUpdate){this.isLocalUpdate=!1;return}if(!this.$el.isConnected){this.log("WATCHER: Component detached, ignoring change");return}if(!this.stateHasBeenInitialized){this.stateHasBeenInitialized=!0,this.log("WATCHER: State initialized (first run)");return}if(this.log("WATCHER: State changed",{newValue:typeof e=="string"?e.substring(0,100):e,oldValue:typeof t=="string"?t.substring(0,100):t,currentUploadedFiles:this.uploadedFiles.substring(0,100),isLocalUpdate:this.isLocalUpdate}),!e||e==="[]"||e==='""'||Array.isArray(e)&&e.length===0){this.uploadedFiles&&this.uploadedFiles!=="[]"&&this.uploadedFiles!=='""'&&this.getCurrentFiles().length>0&&(this.log("State cleared (server sent empty), calling clearAllFiles(SILENT)"),this.clearAllFiles(!1));return}let i=this.normalizeStateValue(e),s=this.normalizeStateValue(this.uploadedFiles);i!==s&&e&&e!=="[]"&&e!=='""'&&this.addFilesFromState(e)})},parseStateValue(e){if(!e)return null;try{return typeof e=="string"?JSON.parse(e):e}catch{return e}},addFilesFromState(e){let i=this.parseStateValue(e);if(Array.isArray(i)||(i=[i]),i=i.filter(l=>l!=null),i.length===0)return!1;let s=this.getUploadcareApi();if(!s||typeof s.addFileFromCdnUrl!="function")return!1;let a=this.getCurrentFiles();console.log("[Uploadcare] addFilesFromState currentFiles",a.length,a);let n=a.map(l=>l?l&&typeof l=="object"?l.cdnUrl:l:null).filter(Boolean);console.log(`[Uploadcare ${this.statePath}] addFilesFromState filesToAdd`,i.length,i),i.forEach((l,u)=>{if(!l){console.warn(`[Uploadcare] Skipping null item at index ${u}`);return}let d=l&&typeof l=="object"?l.cdnUrl:l;if(console.log(`[Uploadcare] Processing item ${u}`,{url:d,item:l}),d&&typeof d=="string"&&(d.includes("ucarecdn.com")||d.includes("ucarecd.net"))&&!n.some(m=>{let y=this.extractUuidFromUrl(d),g=this.extractUuidFromUrl(m);return y&&g&&y===g}))try{s.addFileFromCdnUrl(d)}catch(m){console.error("[Uploadcare] Failed to add file from URL:",d,m)}});let r=[],o=new Set,c=l=>{if(!l)return;let u=l&&typeof l=="object"?l.cdnUrl:l,d=this.extractUuidFromUrl(u);d&&!o.has(d)?(o.add(d),this.isWithMetadata&&typeof l!="object"?r.push({cdnUrl:l,uuid:d,name:"",size:0,mimeType:"",isImage:!1}):r.push(l)):d||r.push(l)},h=this.parseStateValue(e)||[];return(Array.isArray(h)?h:[h]).forEach(c),this.uploadedFiles=JSON.stringify(r),this.isLocalUpdate=!0,!0},normalizeStateValue(e){if(!e)return"";try{let t=typeof e=="string"?JSON.parse(e):e;if(Array.isArray(t)){if(t.every(a=>typeof a=="string"||typeof a=="object"&&a!==null&&("cdnUrl"in a||"uuid"in a)))return JSON.stringify(t);console.log("[Uploadcare] normalizing mixed/raw array",t)}let i=this.formatFilesForState(t);return console.log("[Uploadcare] normalizeStateValue result",i),JSON.stringify(i)}catch(t){return console.error("[Uploadcare] normalizeStateValue error",t),e}},isStateChanged(){let e=this.normalizeStateValue(this.state),t=this.normalizeStateValue(this.initialState);return e!==t},setupEventListeners(e){this.pendingUploads=[],this.pendingRemovals=[];let t=this.createFileUploadSuccessHandler(e),i=this.createFileUrlChangedHandler(e),s=this.createFileRemovedHandler(e),a=this.createFormInputChangeHandler(e),n=r=>{if(r.target!==this.ctx&&!this.ctx.contains(r.target))return;let o=this.$el.closest("form");o&&o.dispatchEvent(new CustomEvent("form-processing-started",{detail:{message:"Uploading file..."}}))};this.ctx.addEventListener("file-upload-started",n),this.ctx.addEventListener("file-upload-success",t),this.ctx.addEventListener("file-url-changed",i),this.ctx.addEventListener("file-removed",s),this.$nextTick(()=>{let r=this.$el.querySelector("uc-form-input input");if(r){r.addEventListener("input",a),r.addEventListener("change",a);let o=new MutationObserver(()=>{a({target:r})});o.observe(r,{attributes:!0,attributeFilter:["value"]}),this.formInputObserver=o}}),this.removeEventListeners=()=>{this.ctx.removeEventListener("file-upload-started",n),this.ctx.removeEventListener("file-upload-success",t),this.ctx.removeEventListener("file-url-changed",i),this.ctx.removeEventListener("file-removed",s);let r=this.$el.querySelector("uc-form-input input");r&&(r.removeEventListener("input",a),r.removeEventListener("change",a)),this.formInputObserver&&(this.formInputObserver.disconnect(),this.formInputObserver=null)}},createFileUploadSuccessHandler(e){let t=null;return i=>{if(i.target.getAttribute("ctx-name")!==this.uniqueContextName&&i.target!==this.ctx&&!this.ctx.contains(i.target))return;let a=this.isWithMetadata?i.detail:i.detail.cdnUrl,n=this.extractUuidFromUrl(a);this.pendingUploads.push(a),t&&clearTimeout(t),t=setTimeout(()=>{try{let r=this.getCurrentFiles();for(let c of this.pendingUploads)r=this.updateFilesList(r,c);this.updateState(r),this.pendingUploads=[];let o=this.$el.closest("form");o&&o.dispatchEvent(new CustomEvent("form-processing-finished"))}catch(r){console.error("[Uploadcare] Error updating state after upload:",r)}},200)}},createFileUrlChangedHandler(e){let t=null;return i=>{if(i.target.getAttribute("ctx-name")!==this.uniqueContextName&&i.target!==this.ctx&&!this.ctx.contains(i.target))return;let a=i.detail;t&&clearTimeout(t),t=setTimeout(()=>{try{let n=this.getCurrentFiles(),r=this.updateFileUrl(n,a);this.updateState(r)}catch(n){console.error("Error updating state after URL change:",n)}},100)}},createFileRemovedHandler(e){let t=null;return i=>{if(i.target.getAttribute("ctx-name")!==this.uniqueContextName&&i.target!==this.ctx&&!this.ctx.contains(i.target))return;let a=i.detail;this.pendingRemovals.push(a),t&&clearTimeout(t),t=setTimeout(()=>{try{let n=this.getCurrentFiles();for(let r of this.pendingRemovals)n=this.removeFile(n,r);this.updateState(n),this.pendingRemovals=[]}catch(n){console.error("Error in handleFileRemoved:",n)}},100)}},createFormInputChangeHandler(e){return t=>{}},getCurrentFiles(){try{let e=this.uploadedFiles?JSON.parse(this.uploadedFiles):[];return Array.isArray(e)?e:[]}catch{return[]}},updateFilesList(e,t){if(this.isMultiple){let i=this.extractUuidFromUrl(t);return e.some(a=>this.extractUuidFromUrl(a)===i)?e:[...e,t]}return[t]},updateFileUrl(e,t){let i=t.uuid;if(!i&&t.cdnUrl&&(i=this.extractUuidFromUrl(t.cdnUrl)),!i)return e;t.uuid||(t={...t,uuid:i});let s=this.findFileIndex(e,i);if(s===-1)return e;let a;if(this.isWithMetadata){let n=e[s];if(typeof n=="string"){let r=this.extractUuidFromUrl(n);n={cdnUrl:n,uuid:r,name:"",size:0,mimeType:"",isImage:!1}}a={...n,...t}}else a=t.cdnUrl;return this.isMultiple?(e[s]=a,e):[a]},removeFile(e,t){let i=this.findFileIndex(e,t.uuid);return i===-1?e:this.isMultiple?(e.splice(i,1),e):[]},findFileIndex(e,t){return t?e.findIndex(i=>{let s=i&&typeof i=="object"?i.cdnUrl:i;return this.extractUuidFromUrl(s)===t}):-1},updateState(e){let t=new Set,i=e.filter(h=>{let l=h&&typeof h=="object"?h.cdnUrl:h,u=this.extractUuidFromUrl(l);return u?t.has(u)?!1:(t.add(u),!0):!0}),s=this.formatFilesForState(i),a=JSON.stringify(s),n=this.getCurrentFiles(),r=JSON.stringify(this.formatFilesForState(n)),o=JSON.stringify(s);r!==o&&(this.uploadedFiles=a,this.isLocalUpdate=!0,this.state=this.uploadedFiles,this.isMultiple&&i.length>1&&this.$nextTick(()=>{this.isLocalUpdate=!1}))},formatFilesForState(e){if(!e)return[];if(!Array.isArray(e))if(console.warn("[Uploadcare] formatFilesForState called with non-array:",typeof e,e),typeof e=="string")try{let t=JSON.parse(e);if(Array.isArray(t))e=t;else return[]}catch{return[]}else return[];return e.map(t=>{if(t&&typeof t=="object"&&!t.cdnUrl&&!t.uuid&&"0"in t){let i=Object.keys(t);if(i.length>5&&i.includes("0")&&i.includes("1")&&i.includes("2")){let s="";if(Math.max(...i.map(n=>parseInt(n)).filter(n=>!isNaN(n)))===i.length-1){let n=new Array(i.length);for(let r=0;r<i.length;r++)n[r]=t[r];s=n.join("")}else s=Object.values(t).join("");if(s.match(/^https?:\/\//)){if(console.warn("[Uploadcare] SELF-HEALED CORRUPTED STRING:",s),this.isWithMetadata){let n=this.extractUuidFromUrl(s);return{cdnUrl:s,uuid:n,name:"",size:0,mimeType:"",isImage:!1}}return s}}}return this.isWithMetadata?t:t&&typeof t=="object"?t.cdnUrl:t})},setupDoneButtonObserver(){let e=this.$el.closest(".uploadcare-wrapper");e&&(this.doneButtonHider=new f(e))},destroy(){this.doneButtonHider&&(this.doneButtonHider.destroy(),this.doneButtonHider=null),this.documentClassObserver&&(this.documentClassObserver.disconnect(),this.documentClassObserver=null),this.formInputObserver&&(this.formInputObserver.disconnect(),this.formInputObserver=null),this.removeEventListeners&&this.removeEventListeners()},extractUuidFromUrl(e){if(!e)return null;let t=e;if(typeof e=="object"){if(e.uuid)return e.uuid;t=e.cdnUrl||""}if(!t||typeof t!="string")return null;if(/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i.test(t))return t;let s=t.match(/\/([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})(?:\/|$)/i);return s&&s[1]?s[1]:null},async syncStateWithUploadcare(e){try{let t=this.getCurrentFilesFromUploadcare(e);if(t.length>0){let r=[];for(let o of t){console.log(`[Uploadcare ${this.statePath}] syncStateWithUploadcare - state item`,o);let c=o&&typeof o=="object"?o.cdnUrl:o;if(typeof c=="string"&&c.match(/[a-f0-9-]{36}~[0-9]+/)){console.log("[Uploadcare] Found group URL:",c);try{let h=await this.fetchGroupFiles(c);console.log("[Uploadcare] Expanded group to:",h.length,"files"),r.push(...h)}catch(h){console.error("[Uploadcare] Failed to expand group:",c,h),r.push(o)}}else r.push(o)}console.log("[Uploadcare] Flattened files count:",r.length),t=r}let i=this.formatFilesForState(t),s=this.buildStateFromFiles(i),a=this.normalizeStateValue(this.uploadedFiles),n=this.normalizeStateValue(s);a!==n&&(this.uploadedFiles=s,this.isLocalUpdate=!0,this.state=this.uploadedFiles)}catch(t){console.error("Error syncing state with Uploadcare:",t)}},async fetchGroupFiles(e){let t=e;if(e.includes("ucarecdn.com")||e.includes("ucarecd.net")){let a=e.match(/\/([a-f0-9-]{36}~[0-9]+)/);a&&(t=a[1])}let i=await fetch(`https://upload.uploadcare.com/group/info/?pub_key=${this.publicKey}&group_id=${t}`);if(!i.ok)throw new Error(`Failed to fetch group info: ${i.statusText}`);let s=await i.json();return s.files?s.files.map(a=>{let n=`https://ucarecdn.com/${a.uuid}/`;return this.isWithMetadata?{uuid:a.uuid,cdnUrl:n,name:a.original_filename,size:a.size,mimeType:a.mime_type,isImage:a.is_image}:n}):[]},buildStateFromFiles(e){return this.isMultiple?JSON.stringify(e):e.length>0?this.isWithMetadata?JSON.stringify(e[0]):e[0]:""},getCurrentFilesFromUploadcare(e){try{if(e&&typeof e.value=="function"){let i=e.value();return i?Array.isArray(i)?i.filter(a=>a!=null):this.parseFormInputValue(i).filter(a=>a!=null):[]}let t=this.$el.querySelector("uc-form-input input");return t?this.parseFormInputValue(t.value).filter(s=>s!=null):[]}catch(t){return console.error("Error getting current files from Uploadcare:",t),[]}},parseFormInputValue(e){if(!e||typeof e=="string"&&e.trim()==="")return[];if(typeof e=="object")return[e];try{let t=JSON.parse(e);return Array.isArray(t)?t.filter(i=>i!==null&&i!==""):t!==null&&t!==""?[t]:[]}catch{return typeof e=="string"&&e.trim()!==""?[e]:[]}},clearAllFiles(e=!0){let t=this.statePath||"unknown";this.log("clearAllFiles called",{uploadedFiles:this.uploadedFiles,state:this.state,emitStateChange:e});let i=this.getUploadcareApi();if(i){this.log("API found, attempting clear",{hasCollection:!!i.collection,hasGetCollection:typeof i.getCollection=="function",hasRemoveAll:typeof i.removeAllFiles=="function"});try{if(i.collection&&typeof i.collection.clear=="function")i.collection.clear();else if(typeof i.getCollection=="function"){let s=i.getCollection();s&&typeof s.clear=="function"&&s.clear()}}catch(s){console.warn(`[Uploadcare ${t}] collection clear error:`,s)}try{typeof i.removeAllFiles=="function"&&i.removeAllFiles()}catch{}try{typeof i.value=="function"?i.value([]):i.value=[]}catch{}}else console.warn(`[Uploadcare ${t}] No API discovered for clearing`);try{let s=this.$el.querySelector("uc-form-input");if(s&&typeof s.getAPI=="function"){let a=s.getAPI();a&&(a.value=this.isMultiple?[]:"")}}catch{}this.uploadedFiles!==(this.isMultiple?"[]":"")&&(this.uploadedFiles=this.isMultiple?"[]":"",this.isLocalUpdate=!0,e&&(this.state=this.uploadedFiles))}}}export{U as default};
